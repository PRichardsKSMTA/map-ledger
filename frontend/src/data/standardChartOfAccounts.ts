import { TargetScoaOption } from '../types';

const descriptions = [
  'OPERATING RATIO - TOTAL ASSET OPERATIONS',
  'FREIGHT REVENUE LINEHAUL - COMPANY FLEET',
  'FREIGHT REVENUE LINEHAUL - OWNER OPERATOR',
  'FREIGHT REVENUE LINEHAUL - LEASE PURCHASE',
  'FREIGHT REVENUE LINEHAUL - BROKERAGE',
  'ACCESSORIAL REVENUE - COMPANY FLEET',
  'ACCESSORIAL REVENUE - OWNER OPERATOR',
  'ACCESSORIAL REVENUE - LEASE PURCHASE',
  'ACCESSORIAL REVENUE - BROKERAGE',
  'FUEL SURCHARGE REVENUE - COMPANY FLEET',
  'FUEL SURCHARGE REVENUE - OWNER OPERATOR',
  'FUEL SURCHARGE REVENUE - LEASE PURCHASE',
  'FUEL SURCHARGE REVENUE - BROKERAGE',
  'DRIVER WAGES - COMPANY FLEET',
  'DRIVER BENEFITS, PAYROLL TAXES AND BONUS COMPENSATION - COMPANY FLEET',
  'PURCHASED TRANSPORTATION - OWNER OPERATOR',
  'PURCHASED TRANSPORTATION - LEASE PURCHASE',
  'PURCHASED TRANSPORTATION - BROKERAGE',
  'BENEFITS AND INCENTIVES - OWNER OPERATOR',
  'BENEFITS AND INCENTIVES - LEASE PURCHASE',
  'FUEL EXPENSE - COMPANY FLEET',
  'FUEL EXPENSE - OWNER OPERATOR',
  'FUEL EXPENSE - LEASE PURCHASE',
  'REEFER FUEL EXPENSE - COMPANY FLEET',
  'REEFER FUEL EXPENSE - OWNER OPERATOR',
  'REEFER FUEL EXPENSE - LEASE PURCHASE',
  'MAINTENANCE EXPENSE - TRACTOR - COMPANY FLEET',
  'VARIABLE (OTHER) DRIVING EXPENSES - COMPANY FLEET',
  'VARIABLE (OTHER) DRIVING EXPENSES - OWNER OPERATOR',
  'VARIABLE (OTHER) DRIVING EXPENSES - LEASE PURCHASE',
  'VARIABLE (OTHER) EXPENSES - BROKERAGE',
  'TRACTOR FIXED EXPENSE - COMPANY FLEET',
  'INSURANCE EXPENSE - COMPANY FLEET',
  'INSURANCE EXPENSE - OWNER OPERATOR',
  'INSURANCE EXPENSE - LEASE PURCHASE',
  'INSURANCE EXPENSE - BROKERAGE',
  'MAINTENANCE EXPENSE - TRAILER - TOTAL ASSET OPERATIONS',
  'TRAILER FIXED EXPENSE - TOTAL ASSET OPERATIONS',
  'MAINTENANCE EXPENSE - WAGES AND OVERHEAD - TOTAL ASSET OPERATIONS',
  'AGENT COMMISSIONS - TOTAL ASSET OPERATIONS',
  'TOLLS - TOTAL ASSET OPERATIONS',
  'RECRUITING, SCREENING AND RETENTION EXPENSE - TOTAL ASSET OPERATIONS',
  'LUMPER / THIRD-PARTY LOAD/UNLOAD EXPENSE',
  'PERMITS AND ESCORT EXPENSE',
  'NON DRIVER WAGES & BENEFITS - TOTAL ASSET OPERATIONS',
  'NON DRIVER WAGES & BENEFITS - BROKERAGE',
  'FIXED OVERHEAD EXPENSE - TOTAL ASSET OPERATIONS',
  'FIXED OVERHEAD EXPENSE - BROKERAGE',
  'OPERATING PROFIT - TOTAL ASSET OPERATIONS',
  'OPERATING PROFIT - BROKERAGE',
  'SUM - TOTAL VARIABLE EXPENSE (INCLUDING FUEL)',
  'SUM - TOTAL VARIABLE EXPENSE (EXCLUDING FUEL)',
  'SUM - TOTAL VARIABLE EXPENSE (EXCLUDING DRIVER COMPENSATION)',
  'SUM - TOTAL VARIABLE EXPENSE (EXCLUDING FUEL AND DRIVER COMPENSATION)',
  'SUM - TOTAL FIXED OVERHEAD EXPENSE',
  'TOTAL MILES DRIVEN - COMPANY FLEET',
  'TOTAL MILES DRIVEN - OWNER OPERATOR',
  'TOTAL MILES DRIVEN - LEASE PURCHASE',
  'NUMBER OF LOADS - COMPANY FLEET',
  'NUMBER OF LOADS - OWNER OPERATOR',
  'NUMBER OF LOADS - LEASE PURCHASE',
  'NUMBER OF LOADS - BROKERAGE',
  'TRACTOR COUNT  - COMPANY FLEET',
  'TRACTOR COUNT  - OWNER OPERATOR',
  'TRACTOR COUNT  - LEASE PURCHASE',
  'TRAILER COUNT - TOTAL ASSET OPERATIONS',
  'DRIVER COUNT - COMPANY FLEET',
  'DRIVER COUNT - OWNER OPERATOR',
  'DRIVER COUNT - LEASE PURCHASE',
  'NON-DRIVER COUNT - TOTAL ASSET OPERATIONS',
  'MECHANIC/TECHNICIAN COUNT - TOTAL ASSET OPERATIONS',
  'CARRIER COUNT - BROKERAGE',
  'HEAD COUNT - BROKERAGE',
  'TOTAL ASSET OPERATIONS - AUTO LIABILITY POLICY LIMITS - INCLUDING EXCESS',
  'TOTAL ASSET OPERATIONS - MAINTENANCE EXPENSE - TRAILER - OUTSIDE VENDOR - TOTAL ASSET OPERATIONS',
  'MAINTENANCE EXPENSE - TRACTOR - TIRES - COMPANY FLEET',
  'MAINTENANCE EXPENSE - TRAILER - TIRES - OUTSIDE VENDOR -TOTAL ASSET OPERATIONS',
  'MAINTENANCE EXPENSE - TRAILER - TIRES - TOTAL ASSET OPERATIONS',
  'MAINTENANCE EXPENSE - TRACTOR - OUTSIDE VENDOR - COMPANY FLEET',
  'MAINTENANCE EXPENSE - TRACTOR - TIRES - OUTSIDE VENDOR - COMPANY FLEET',
] as const;

const glIds: readonly number[] = [
  2990,
  2,
  3,
  296,
  102,
  4,
  5,
  299,
  105,
  6,
  7,
  302,
  108,
  8,
  89,
  9,
  351,
  113,
  90,
  354,
  10,
  11,
  907,
  381,
  382,
  901,
  12,
  24,
  25,
  314,
  131,
  18,
  22,
  23,
  311,
  128,
  14,
  20,
  16,
  270,
  91,
  254,
  902,
  906,
  26,
  136,
  28,
  139,
  30,
  31,
  903,
  904,
  908,
  909,
  905,
  32,
  33,
  358,
  34,
  35,
  363,
  147,
  36,
  37,
  368,
  38,
  304,
  305,
  378,
  310,
  316,
  322,
  323,
  320,
  278,
  256,
  290,
  258,
  272,
  284,
];

const sanitize = (description: string): string =>
  description
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-+|-+$/g, '')
    .replace(/-{2,}/g, '-');

export const STANDARD_CHART_OF_ACCOUNTS: TargetScoaOption[] = descriptions.map((description, index) => {
  const glId = glIds[index];

  if (glId === undefined) {
    throw new Error(`Missing GL ID for Standard SCoA description: ${description}`);
  }

  const slug = sanitize(description) || `account-${index + 1}`;
  const id = `standard-scoa-${glId}-${slug}`;

  return {
    id,
    value: String(glId),
    label: description,
  };
});

export const STANDARD_CHART_OF_ACCOUNT_IDS = glIds;

export const STANDARD_CHART_OF_ACCOUNT_DESCRIPTIONS = descriptions;

export const getStandardScoaOption = (description: string): TargetScoaOption => {
  const match = STANDARD_CHART_OF_ACCOUNTS.find(
    option => option.label.toLowerCase() === description.toLowerCase(),
  );

  if (!match) {
    throw new Error(`Standard SCOA option not found for description: ${description}`);
  }

  return match;
};
